<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Teleprompter Profissional</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }

        body {
            background-color: #000;
            color: #fff;
            height: 100vh;
            overflow: hidden;
            touch-action: none;
        }

        .teleprompter-container {
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 10px;
        }

        .teleprompter-frame {
            width: 95%;
            height: 70vh;
            border: 3px solid #333;
            border-radius: 5px;
            overflow: hidden;
            position: relative;
            background-color: #111;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        .teleprompter-text {
            width: 100%;
            height: 100%;
            padding: 20px;
            font-size: 24px;
            line-height: 1.5;
            color: #fff;
            background-color: #111;
            position: absolute;
            top: 0;
            left: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            transform: translateY(100%);
            transition: transform 0.01s linear;
        }

        .controls {
            width: 100%;
            padding: 15px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            background-color: #222;
            border-radius: 5px;
            margin-top: 10px;
        }

        button {
            padding: 10px 15px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            background-color: #444;
            color: #fff;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #555;
        }

        button.active {
            background-color: #ff5555;
        }

        .speed-controls {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
        }

        textarea {
            width: 100%;
            height: 150px;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
            border: 1px solid #444;
            background-color: #333;
            color: #fff;
            font-size: 16px;
            resize: none;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .modal-content {
            background-color: #333;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            max-width: 80%;
        }

        .modal button {
            margin-top: 15px;
        }

        @media (max-width: 600px) {
            .teleprompter-text {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="teleprompter-container">
        <div class="teleprompter-frame">
            <div class="teleprompter-text" id="teleprompterText">
                Digite ou cole seu texto acima e clique em "Iniciar".
            </div>
        </div>

        <textarea id="textInput" placeholder="Digite ou cole seu texto aqui..."></textarea>

        <div class="controls">
            <div class="speed-controls">
                <button onclick="setSpeed(0.5)">0.5x</button>
                <button onclick="setSpeed(0.75)">0.75x</button>
                <button onclick="setSpeed(1)">1x</button>
                <button onclick="setSpeed(1.5)">1.5x</button>
                <button onclick="setSpeed(2)">2x</button>
            </div>

            <button id="playPauseBtn" onclick="togglePlayPause()">Iniciar</button>
            <button id="recordBtn" onclick="toggleRecord()">Gravar</button>
        </div>
    </div>

    <div class="modal" id="confirmModal">
        <div class="modal-content">
            <h2>Gravação finalizada!</h2>
            <p>Seu vídeo foi salvo automaticamente no seu dispositivo.</p>
            <button onclick="closeModal()">OK</button>
        </div>
    </div>

    <script>
        let isPlaying = false;
        let isRecording = false;
        let scrollPosition = 0;
        let scrollSpeed = 1;
        let animationId = null;
        let mediaRecorder;
        let recordedChunks = [];

        const teleprompterText = document.getElementById('teleprompterText');
        const textInput = document.getElementById('textInput');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const recordBtn = document.getElementById('recordBtn');
        const modal = document.getElementById('confirmModal');

        function updateTeleprompter() {
            if (scrollPosition > teleprompterText.scrollHeight - teleprompterText.clientHeight) {
                pauseTeleprompter();
                return;
            }

            scrollPosition += scrollSpeed;
            teleprompterText.style.transform = `translateY(calc(100% - ${scrollPosition}px))`;
            animationId = requestAnimationFrame(updateTeleprompter);
        }

        function togglePlayPause() {
            if (isPlaying) {
                pauseTeleprompter();
            } else {
                startTeleprompter();
            }
        }

        function startTeleprompter() {
            if (textInput.value.trim() === '') {
                alert('Por favor, digite ou cole um texto.');
                return;
            }

            teleprompterText.textContent = textInput.value;
            scrollPosition = 0;
            isPlaying = true;
            playPauseBtn.textContent = 'Pausar';
            updateTeleprompter();
        }

        function pauseTeleprompter() {
            isPlaying = false;
            playPauseBtn.textContent = 'Iniciar';
            cancelAnimationFrame(animationId);
        }

        function setSpeed(speed) {
            scrollSpeed = speed;
            document.querySelectorAll('.speed-controls button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        async function toggleRecord() {
            if (isRecording) {
                stopRecording();
            } else {
                startRecording();
            }
        }

        async function startRecording() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({
                    audio: true,
                    video: {
                        facingMode: 'user',
                        width: { ideal: 1280 },
                        height: { ideal: 720 }
                    }
                });

                mediaRecorder = new MediaRecorder(stream, { mimeType: 'video/webm' });
                recordedChunks = [];

                mediaRecorder.ondataavailable = (event) => {
                    if (event.data.size > 0) {
                        recordedChunks.push(event.data);
                    }
                };

                mediaRecorder.onstop = () => {
                    const blob = new Blob(recordedChunks, { type: 'video/webm' });
                    const url = URL.createObjectURL(blob);

                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `gravacao-${new Date().toISOString().slice(0, 10)}.webm`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);

                    showModal();
                };

                mediaRecorder.start(100);
                isRecording = true;
                recordBtn.textContent = 'Parar';
                recordBtn.classList.add('active');
            } catch (error) {
                alert('Erro ao acessar a câmera/microfone: ' + error.message);
            }
        }

        function stopRecording() {
            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                mediaRecorder.stop();
                mediaRecorder.stream.getTracks().forEach(track => track.stop());
                isRecording = false;
                recordBtn.textContent = 'Gravar';
                recordBtn.classList.remove('active');
            }
        }

        function showModal() {
            modal.style.display = 'flex';
        }

        function closeModal() {
            modal.style.display = 'none';
        }

        // Fechar modal ao clicar fora
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                closeModal();
            }
        });
    </script>
</body>
</html>
